# mama

mama는 사용자 정보에 맞게 LiteLLM Virtual Key를 손쉽게 관리할 수 있는 Key Management 시스템입니다. 관리자는 Web UI를 통해 사용자 정보를 관리할 수 있으며, 관련 시스템은 REST API를 통해 Key와 사용자 정보를 얻을 수 있습니다.

## 요구사항
- 관리자가 권한 업데이트 할 수 있는 Web UI를 제공한다
  - 슈퍼 관리자는 정보는 admin/admin으로 최초 생성된다
  - 슈퍼 관리자는 관리자 계정을 생성/삭제 할 수 있어야 한다
  - 관리자는 자신의 패스워드를 변경할 수 있다
  - 사용자 정보는 ID, 조직, 키, 허용 모델, 허용 서비스, 기타 정보를 포함
  - 다수 사용자의 정보를 조회 할 수 있다
  - 다수 사용자의 정보를 동시에 변경 할 수 있다
  - 허용 모델과 서비스 정보를 업데이트 할 때 교체, 추가, 삭제 할 수 있다
- 사용자 정보를 통해 Key를 조회할 수 있는 REST API를 제공한다
  - 다수의 사용자 ID를 입력 받고, 그에 해당하는 정보를 반환한다
- 발급된 Key를 포함한 사용자 정보는 DB에 저장된다
- 모든 사용자 정보 조회/수정 이벤트와 API 요청은 결과와 함께 저장된다

## 작업 순서
1. 데이터베이스 및 데이터 모델 설계
   - 사용자, 키, 허용 모델/서비스, 이벤트 로그 등 테이블 구조 설계 및 DB 반영
2. 슈퍼 관리자(admin/admin) 계정 자동 생성 로직 구현
3. 인증 및 권한 관리 기능 구현
   - 로그인, 패스워드 변경, 관리자/슈퍼관리자 권한 구분 등
4. Web UI 관리자 기능 구현
   - 관리자 계정 생성/삭제
   - 패스워드 변경
   - 사용자 정보 등록/조회/수정
   - 허용 모델/서비스 관리 등
   - 다수 사용자 동시 처리 (사용성 개선)
5. REST API 구현
   - 사용자 ID 리스트로 정보 및 키 반환 API
6. 이벤트 및 API 요청 로그 저장 기능 구현
   - 모든 정보 조회/수정, API 요청 결과를 이벤트 로그로 저장
7. 테스트 및 문서화
   - 각 기능별 테스트 코드 작성 및 문서 보완

## TODO
- LiteLLM 모듈이 현재 사용가능한 모델 조회하는 기능
- LiteLLM 모듈이 키를 생성/삭제하는 기능
- LiteLLM 모듈 - LiteLLM에 접근해서 Key를 생성하는 모듈 구현
- LiteLLM 모듈이 Key의 alias를 생성 및 업데이트하는 기능, 조회 안됨
- LiteLLM 모듈이 Key가 사용가능한 모델을 설정하는 기능
- backend - LiteLLM에서 현재 사용가능한 모델 정보를 조회해서 제공하는 api
- frontend - 현재 사용가능한 모델 정보를 불러와서 사용자 생성시에 선택해서 사용할 수 있게 함
- frontend - 사용자 정보 출력시 현재 사용 가능하지 않은 모델은 붉은색으로 표시
- frontend - JWT 토큰 만료된 경우, logout 처리 및 루트로 이동
- frontend - 사용자 동시에 여러명 생성하기
- frontend - 모든 모델 설정은 어떻게 되지, "all-team-models" 추가 할 수 있게.
- frontend - 사용자 리스트 정렬 기능 제공 (각 항목 테이블 헤드 클릭으로)
- frontend - 사용자 리스트에서 검색 기능 추가, 키워드 입력하면 id, 조직 기준으로 검색된 사용자만 표시되게 해줘.
- frontend - 사용자 정보 클릭하면 정보 수정 가능한 다이얼로그가 떠서 수정할 수 있게
- frontend - 복수의 사용자를 선택해서 모델 정보를 수정할 수 있는 기능 추가
- frontend - 복수의 사용자를 선택해서 삭제할 수 있는 기능 추가
---
- 리패터링 - 불필요한 코드, 디버깅 코드, 테스트 방법 강구


## Deployment Guide

### Docker Compose 통합 배포 (권장)

백엔드와 프론트엔드가 하나의 서버에서 실행됩니다.

```bash
docker compose up -d --build
```

DB 마이그레이션 수행

```bash
docker compose run --rm migrate
```

- 웹 애플리케이션: http://localhost:8000
- API 문서: http://localhost:8000/docs
